<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <title>gnutls_handshake_set_hook_function(3) — Linux manual
  pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="gnutls_handshake_set_hook_function(3) — Linux manual pages" />

  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve">
</script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>

<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>

          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>

          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>

  <div class="refentry">
    <a id="gnutls-handshake-set-hook-function.3" name="gnutls-handshake-set-hook-function.3" shape="rect"> </a>

    <div class="titlepage"> </div>

    <div class="refnamediv">
      <h2>Name</h2>

      <p>gnutls_handshake_set_hook_function — API
      function</p>
    </div>

    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>

      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">
#include &lt;gnutls/gnutls.h&gt;
</pre>

        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">void
            <strong>gnutls_handshake_set_hook_function</strong>(</code></td>

            <td rowspan="1" colspan="1">gnutls_session_t <var class="pdparam">session</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">unsigned int <var class="pdparam">htype</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">int <var class="pdparam">post</var>,</td>
          </tr>

          <tr>
            <td rowspan="1" colspan="1"> </td>

            <td rowspan="1" colspan="1">gnutls_handshake_hook_func <var class="pdparam">func</var><code>)</code>;</td>
          </tr>
        </table>

        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>

    <div class="refsect1">
      <a id="gnutls-handshake-set-hook-function-3_sect1" name="gnutls-handshake-set-hook-function-3_sect1" shape="rect"> </a>

      <h2>ARGUMENTS</h2>

      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="emphasis"><em>gnutls_session_t
          session</em></span></span></dt>

          <dd>
            <p>is a <span class="type">gnutls_session_t</span>
            structure</p>
          </dd>

          <dt><span class="term"><span class="type">unsigned int
          htype</span></span></dt>

          <dd>
            <p>the <span class="type">gnutls_handshake_description_t</span> of the
            message to hook at</p>
          </dd>

          <dt><span class="term"><span class="emphasis"><em>int
          post</em></span></span></dt>

          <dd>
            <p><code class="constant">GNUTLS_HOOK_</code>*
            depending on when the hook function should be
            called</p>
          </dd>

          <dt><span class="term"><span class="emphasis"><em>gnutls_handshake_hook_func
          func</em></span></span></dt>

          <dd>
            <p>is the function to be called</p>
          </dd>
        </dl>
      </div>
    </div>

    <div class="refsect1">
      <a id="gnutls-handshake-set-hook-function-3_sect2" name="gnutls-handshake-set-hook-function-3_sect2" shape="rect"> </a>

      <h2>DESCRIPTION</h2>

      <p>This function will set a callback to be called after or
      before the specified handshake message has been received or
      generated. This is a generalization of <code class="function">gnutls_handshake_set_post_client_hello_function</code>().</p>

      <p>To call the hook function prior to the message being
      sent/generation use <code class="constant">GNUTLS_HOOK_PRE</code> as <em class="parameter"><code>post</code></em> parameter, <code class="constant">GNUTLS_HOOK_POST</code> to call after, and
      <code class="constant">GNUTLS_HOOK_BOTH</code> for both
      cases.</p>

      <p>This callback must return 0 on success or a gnutls error
      code to terminate the handshake.</p>

      <p>Note to hook at all handshake messages use an <em class="parameter"><code>htype</code></em> of <code class="constant">GNUTLS_HANDSHAKE_ANY</code>.</p>
    </div>

    <div class="refsect1">
      <a id="gnutls-handshake-set-hook-function-3_sect3" name="gnutls-handshake-set-hook-function-3_sect3" shape="rect"> </a>

      <h2>WARNING</h2>

      <p>You should not use this function to terminate the
      handshake based on client input unless you know what you are
      doing. Before the handshake is finished there is no way to
      know if there is a man−in−the−middle attack
      being performed.</p>
    </div>

    <div class="refsect1">
      <a id="gnutls-handshake-set-hook-function-3_sect4" name="gnutls-handshake-set-hook-function-3_sect4" shape="rect"> </a>

      <h2>RETURNS</h2>

      <p><span class="errorname">GNUTLS_E_SUCCESS</span> on
      success, or an error code.</p>
    </div>

    <div class="refsect1">
      <a id="gnutls-handshake-set-hook-function-3_sect5" name="gnutls-handshake-set-hook-function-3_sect5" shape="rect"> </a>

      <h2>REPORTING BUGS</h2>

      <p>Report bugs to &lt;bugs@gnutls.org&gt;.</p>

      <p>Home page: http://www.gnutls.org</p>
    </div>

    <div class="refsect1">
      <a id="gnutls-handshake-set-hook-function-3_sect7" name="gnutls-handshake-set-hook-function-3_sect7" shape="rect"> </a>

      <h2>SEE ALSO</h2>

      <p>The full documentation for <em class="citetitle">gnutls</em> is maintained as a Texinfo manual. If
      the /usr/share/doc/gnutls/ directory does not contain the
      HTML form visit</p>

      <div class="itemizedlist">
        <ul class="itemizedlist" style="list-style-type: disc;">
          <li class="listitem">
            <p><a class="literalurl" href="http://www.gnutls.org/manual/" target="_top" shape="rect">http://www.gnutls.org/manual/</a></p>
          </li>
        </ul>
      </div>

      <div class="license">
        <table style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>

          <thead>
            <tr>
              <th style="" rowspan="1" colspan="1">COPYRIGHT</th>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <p>Copyright © 2001-2014 Free Software
                Foundation, Inc..</p>

                <p>Copying and distribution of this file, with or
                without modification, are permitted in any medium
                without royalty provided the copyright notice and
                this notice are preserved.</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
